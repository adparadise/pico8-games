pico-8 cartridge // http://www.pico-8.com
version 5
__lua__
STANDING = 1
AIRBORNE = 2
JUMPING = 3

LEFT_BUTTON = 1
RIGHT_BUTTON = 2
JUMP_BUTTON = 4

JUMP_TIME = 3
JUMP_SPEED = 6
MAX_TIME = 20000
MAX_RUN_SPEED = 4
RUN_ACCEL = 1
GRAVITY_ACCEL = 0.8
STANDING_FRICTION = 0.6
MIN_FRICTION_SPEED = 0.4
AIR_ACCEL = 0.7
AIR_FRICTION = 0.8

SOLID_GROUND = 1

t = 0
players = {}
is_running = true
is_replaying = true
replay_inputs = {}
replay_inputs_index = 1
replay_inputs_index_t = 0
replay_index = 1
lead_countdown = 3

replays = {
-- 1. drop: through top right
{ x = 35, y = 92, inputs = {
   {b=RIGHT_BUTTON,d=3},
   {b=bor(RIGHT_BUTTON,JUMP_BUTTON),d=1},
   {b=RIGHT_BUTTON,d=3},
   {b=bor(LEFT_BUTTON),d=18},
   {b=0,d=5} }
},
-- 2. drop: into right side
{ x = 37, y = 92, inputs = {
   {b=RIGHT_BUTTON,d=3},
   {b=bor(RIGHT_BUTTON,JUMP_BUTTON),d=1},
   {b=RIGHT_BUTTON,d=3},
   {b=bor(LEFT_BUTTON),d=18},
   {b=0,d=2} }
},
-- 3. upward: through bottom left
{ x = 51, y = 114, inputs = {
   {b=bor(LEFT_BUTTON),d=3},
   {b=bor(LEFT_BUTTON,JUMP_BUTTON),d=4},
   {b=0,d=5} }
},
-- 4. walk: into left wall
{ x = 18, y = 116, inputs = {
   {b=0,d=3},
   {b=bor(LEFT_BUTTON),d=8},
   {b=bor(LEFT_BUTTON),d=8}, }
},
-- 5. walk: into right wall
{ x = 108, y = 116, inputs = {
   {b=0,d=3},
   {b=bor(RIGHT_BUTTON),d=8},
   {b=bor(RIGHT_BUTTON),d=8}, }
}
}
replay_only = nil

function _init()
  if (is_replaying) then
    if (replay_only != nil) then
      replay_index = replay_only
    end
    init_replay(replay_index)
  end
  if (not is_replaying) then
    init_gameplay()
  end
end

function init_gameplay()
  t = 0
  for i = 0,1 do
    players[i] = create_player(0,33,88)
  end
end

function init_replay(index)
  local is_finished = false

  local replay = replays[index]
  if (replay != nil) then
    for i = 0,1 do
      players[i] = create_player(0, replay.x, replay.y)
    end
    replay_inputs = replay.inputs

    t = 0
    replay_inputs_index = 1
    replay_inputs_index_t = 0
  end
  if (replay == nil) then
    is_finished = true
  end

  return is_finished
end

function _update()
  if (is_running) then
    if (not is_replaying) then
      update_gameplay()
    end
    if (is_replaying) then
      if (lead_countdown == 0) then
        is_replay_finished = update_replay()
        if (is_replay_finished and replay_only != nil) then
          is_running = false
        end
        if (is_replay_finished and replay_only == nil) then
          replay_index += 1
          is_finished = init_replay(replay_index)
          if (is_finished) then
            is_running = false
          end
        end
      end
    end
    if (lead_countdown > 0) then
      lead_countdown -= 1
    end
  end
end

function _draw()
  cls()
  draw_level()
  for player in all(players) do
    draw_player(player)
  end
end

function update_gameplay()
  update_time()
  update_player_buttons()
  for player in all(players) do
    update_player(player)
  end
end

function update_replay()
  local is_replay_finished

  update_time()
  is_replay_finished = update_replay_buttons()
  for player in all(players) do
    update_player(player)
  end

  return is_replay_finished
end

function update_player_buttons()
  local buttons = btn()
  for player in all(players) do
    player.buttons = band(shr(buttons, player.input * 8), 127)
  end
end

function update_replay_buttons()
  local buttons = 0
  local replay = replay_inputs[replay_inputs_index]
  local is_replay_finished = false
  if replay != nil then
    buttons = replay.b
    replay_inputs_index_t += 1
    if (replay_inputs_index_t >= replay.d) then
      replay_inputs_index += 1
      replay_inputs_index_t = 0
    end
  end
  players[1].buttons = buttons
  is_replay_finished = replay_inputs_index == #replay_inputs

  return is_replay_finished
end

function create_player(input,x,y)
  local player = {}
  player.input = input
  player.x = x
  player.y = y
  player.w = 6
  player.h = 8
  player.ax = 0
  player.vy = 0
  player.vx = 0
  player.state = AIRBORNE
  player.jump_until = 0
  player.jump_released = true
  return player
end

function update_time()
  if (t > MAX_TIME) then
    t = t - MAX_TIME

    for player in all(players) do
      player.jump_until -= MAX_TIME
    end
  end
  t += 1
end

function update_player(player)
  update_player_inputs(player)
  update_player_forces(player)
  update_player_kinetics(player)
end

function update_player_inputs(player)
  if (player.state == STANDING) then
    if (band(player.buttons, LEFT_BUTTON) > 0) then
      player.ax = -RUN_ACCEL
    end
    if (band(player.buttons, RIGHT_BUTTON) > 0) then
      player.ax = RUN_ACCEL
    end
    if (band(player.buttons, RIGHT_BUTTON) == 0 and band(player.buttons, LEFT_BUTTON) == 0) then
      player.ax = 0
    end
  end

  if (player.state == STANDING and band(player.buttons, JUMP_BUTTON) > 0 and player.jump_released) then
    player.state = JUMPING
    player.jump_until = t + JUMP_TIME
    player.vy =- JUMP_SPEED
    player.jump_released = false
    player.jump_direction = 0
    if (player.vx < 0) then
      player.jump_direction = -1
    end
    if (player.vx > 0) then
      player.jump_direction = 1
    end
  end
  if (player.jump_released == false and band(player.buttons, JUMP_BUTTON) == 0) then
    player.jump_released = true
  end
  if (player.state == JUMPING and band(player.buttons, JUMP_BUTTON) == 0) then
    player.state = AIRBORNE
  end
  if (player.state == JUMPING and t == player.jump_until) then
    player.jump_until = 0
    player.state = AIRBORNE
  end

  if (player.state == JUMPING or player.state == AIRBORNE) then
    player.ax = 0
    if (band(player.buttons, LEFT_BUTTON) > 0) then
      player.ax = -AIR_ACCEL
      player.jump_direction = -1
    end
    if (band(player.buttons, RIGHT_BUTTON) > 0) then
      player.ax = AIR_ACCEL
      player.jump_direction = 1
    end
  end
end

function update_player_forces(player)
  if (player.state == STANDING and player.ax == 0) then
    player.vx -= player.vx * STANDING_FRICTION
  end
  if ((player.state == AIRBORNE or player.state == JUMPING) and player.ax == 0) then
    player.vx -= player.vx * AIR_FRICTION
  end
  if (player.state == AIRBORNE and player.vy < 3) then
    player.vy += GRAVITY_ACCEL
  end
  player.vx += player.ax
  if (player.vx > MAX_RUN_SPEED) then
    player.vx = MAX_RUN_SPEED
  end
  if (player.vx < -MAX_RUN_SPEED) then
    player.vx = -MAX_RUN_SPEED
  end
end

function update_player_kinetics(player)
  if (player.vx > -MIN_FRICTION_SPEED and player.vx < MIN_FRICTION_SPEED) then
    player.vx = 0
    player.x = flr(player.x)
  end

  local next = {
    x = player.x + player.vx,
    y = player.y + player.vy,
    is_updated = false
  }
  player.cells = {}

  update_player_common_kinetics(player, next)
  if (player.state == AIRBORNE or player.state == JUMPING) then
    update_player_airborne_kinetics(player, next)
  end
  if (player.state == STANDING) then
    update_player_standing_kinetics(player, next)
  end

  player.y = next.y
  player.x = next.x
end

function update_player_common_kinetics(player, next)
  local dx = 0
  local xflags = 0

  if (player.vx > 0) then
    dx = 1
  end
  if (player.vx < 0) then
    dx =- 1
  end

  if (dx > 0) then
    local cy

    next.cellx = flr((next.x + player.w/2)/8)
    cy = flr(player.y/8)

    player.cells[#player.cells + 1] = {x = next.cellx, y = cy}

    xflags = fget(mget(next.cellx, cy))
  end
  if (dx < 0) then
    local cy

    next.cellx = flr((next.x - player.w/2)/8)
    cy = flr(player.y/8)

    player.cells[#player.cells + 1] = {x = next.cellx, y = cy}

    xflags = fget(mget(next.cellx, cy))
  end

  if (band(xflags, SOLID_GROUND) > 0) then
    if (dx < 0) then
      next.x = (next.cellx+1)*8+player.w/2
      player.vx = 0
      next.is_updated = true
    end
    if (dx > 0) then
      next.x = next.cellx*8-player.w/2
      player.vx = 0
      next.is_updated = true
    end
  end
end

function update_player_airborne_kinetics(player, next)
  local dy = 0
  local yflags = 0
  if (player.vy > 0) then
    dy = 1
  end
  if (player.vy < 0) then
    dy =- 1
  end

  if (dy > 0) then
    local cx1
    local cx2
    local lflags
    local rflags

    next.celly = flr((next.y + player.h/2)/8)
    cx1 = flr((player.x-player.w/2+1)/8)
    cx2 = flr((player.x+player.w/2-1)/8)

    lflags = fget(mget(cx1, next.celly))
    rflags = fget(mget(cx2, next.celly))

    player.cells[#player.cells + 1] = {x = cx1, y = next.celly}
    player.cells[#player.cells + 1] = {x = cx2, y = next.celly}

    yflags = bor(lflags, rflags)
  end
  if (dy < 0) then
    local cx1
    local cx2
    local lflags
    local rflags

    next.celly = flr((next.y - player.h/2)/8)
    cx1 = flr((player.x-player.w/2+1)/8)
    cx2 = flr((player.x+player.w/2-1)/8)

    lflags = fget(mget(cx1, next.celly))
    rflags = fget(mget(cx2, next.celly))

    player.cells[#player.cells + 1] = {x = cx1, y = next.celly}
    player.cells[#player.cells + 1] = {x = cx2, y = next.celly}

    yflags = bor(lflags, rflags)
  end

  if (band(yflags, SOLID_GROUND) > 0) then
    if (dy < 0) then
      next.y = (next.celly+1)*8+player.h/2
      player.vy = 0
      next.is_updated = true
    end
    if (dy > 0) then
      next.y = next.celly*8-player.h/2
      player.vy = 0
      player.state = STANDING
      player.jump_direction = 0
      next.is_updated = true
    end
  end

  if (not next.is_updated and next.cellx != nil and next.celly != nil) then
    local flags = fget(mget(next.cellx, next.celly))
    player.cells[#player.cells + 1] = {x = next.cellx, y = next.celly}
    if (band(flags, SOLID_GROUND) > 0) then
      local nextx = player.x
      local nexty = player.y
      if (player.vx < 0) then
        nextx = (next.cellx)*8+player.w/2
      end
      if (player.vx > 0) then
        nextx = next.cellx*8-player.w/2
      end
      if (player.vy < 0) then
        nexty = (next.celly+1)*8+player.h/2
      end
      if (player.vy > 0) then
        nexty = next.celly*8-player.h/2
      end


      local magx
      local magy
      magx = abs(player.x - nextx)
      magy = abs(player.y - nexty)

      if (magx < magy) then
        next.x = nextx
        player.vx = 0
        next.is_updated = true
      end
      if (magy > magx) then
        if (player.vy < 0) then
          next.y = nexty
          player.vy = 0
          next.is_updated = true
        end
        if (player.vy > 0) then
          next.y = nexty
          player.vy = 0
          player.state = STANDING
          player.jump_direction = 0
          next.is_updated = true
        end
      end
    end
  end
end

function update_player_standing_kinetics(player, next)
  local dx = player.vx
  local cy
  local nxr
  local nxl
  local lflags
  local rflags
  local flags

  cy = flr((player.y + player.h/2 + 1)/8)
  nxr = flr((next.x + player.w/2 + 1)/8)
  nxl = flr((next.x - player.w/2)/8)

  lflags = fget(mget(nxr, cy))
  rflags = fget(mget(nxl, cy))

  player.cells[#player.cells + 1] = {x = nxr, y = cy}
  player.cells[#player.cells + 1] = {x = nxl, y = cy}

  flags = bor(lflags, rflags)

  if (band(flags, SOLID_GROUND) == 0) then
    player.state = AIRBORNE
  end
end

function draw_level()
  map(0,0,0,0,16,18)
end

function draw_player(player)
  draw_player_debug(player)
  spr(7,player.x-4,player.y-4)
end

function draw_player_debug(player)
  print(player.x)
  print(player.y)
  for cell in all(player.cells) do
    local col = 3
    if (cell.col != nil) then
      col = cell.col
    end
    rect(cell.x*8, cell.y*8, cell.x*8 + 7, cell.y*8 + 7, col)
  end
end
__gfx__
00000000000000067777750000000000000000000000000000000000033333300000000000000000000000000000000000000000000000000000000000000000
00000000000577777700000000000000000000000000bb000000000003bbbb300000000000000000000000000000000000000000000000000000000000000000
00000000007777770000000000000000000000000000bb000000000003bbbb300000000000000000000000000000000000000000000000000000000000000000
0000000006777770000000000000000000000000000000000000000003bbbb300000000000000000000000000000000000000000000000000000000000000000
0000000007777760000000000000000000000000000000000000000003bbbb300000000000000000000000000000000000000000000000000000000000000000
0000000006777770000000000000bb000000000000000b000000000003bbbb300000000000000000000000000000000000000000000000000000000000000000
0000000000777777000000000000bb3000000000000000bb7776500003bbbb300000000000000000000000000000000000000000000000000000000000000000
000000000005777777000000000000030000000000000b0000000000033333300000000000000000000000000000000000000000000000000000000000000000
00000000000000067777750000000b00000000000000b00000000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000bb77765000000b000b00000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000b000000000000000b00b00000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000b00b000000000000b00b0000000000000000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000000000b0b000000000000000b0000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000bb0b000000000000000b0000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
54444445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
52444445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
54444425000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
54424445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
54444445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
52444445000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
55555555000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0000000000000000000000000000000000000000000000000000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
2020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000002020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202020000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2000000000000000000000000000002000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
2020202020202020202020202020202000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__sfx__
000100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__music__
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344
00 41424344

